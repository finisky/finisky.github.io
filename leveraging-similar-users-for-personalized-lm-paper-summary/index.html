<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo.png">
  <link rel="mask-icon" href="/images/logo.png" color="#222">
  <meta name="google-site-verification" content="oFhcvcGsjsTY5AFUaI-ezbn7-bel9NrdUNpeQfwZSwI">
  <meta name="msvalidate.01" content="F8E2F274161B653649F8818FD127CE87">
  <meta name="yandex-verification" content="ff1f79abcbf80d7e">
  <meta name="baidu-site-verification" content="XG2u6IqsZb">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"finisky.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.5.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="今天来看看这篇 ACL2022 的文章： [ACL2022] Leveraging Similar Users for Personalized Language Modeling with Limited Data 解决的问题很容易理解，个性化语言模型在用户刚加入时缺少数据的冷启动问题：  Personalized language models are designed and trained">
<meta property="og:type" content="article">
<meta property="og:title" content="Leveraging Similar Users for Personalized Language Modeling with Limited Data 简读">
<meta property="og:url" content="https://finisky.github.io/leveraging-similar-users-for-personalized-lm-paper-summary/index.html">
<meta property="og:site_name" content="Finisky Garden">
<meta property="og:description" content="今天来看看这篇 ACL2022 的文章： [ACL2022] Leveraging Similar Users for Personalized Language Modeling with Limited Data 解决的问题很容易理解，个性化语言模型在用户刚加入时缺少数据的冷启动问题：  Personalized language models are designed and trained">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-10-08T11:28:27.000Z">
<meta property="article:modified_time" content="2022-10-08T11:37:31.000Z">
<meta property="article:author" content="finisky">
<meta property="article:tag" content="Machine Learning">
<meta property="article:tag" content="NLP">
<meta property="article:tag" content="NLG">
<meta property="article:tag" content="Language Model">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://finisky.github.io/leveraging-similar-users-for-personalized-lm-paper-summary/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://finisky.github.io/leveraging-similar-users-for-personalized-lm-paper-summary/","path":"leveraging-similar-users-for-personalized-lm-paper-summary/","title":"Leveraging Similar Users for Personalized Language Modeling with Limited Data 简读"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Leveraging Similar Users for Personalized Language Modeling with Limited Data 简读 | Finisky Garden</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-96909088-2"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-96909088-2","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>



<link rel="dns-prefetch" href="https://finiskycomments.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start --><script type="text/javascript"> function downloadJsAtOnload() { setTimeout(function downloadJs() { var element = document.createElement("script"); element.setAttribute("data-ad-client", "ca-pub-2660281922577700"); element.async = true; element.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"; document.body.appendChild(element); }, 5000); }; if (window.addEventListener) window.addEventListener("load", downloadJsAtOnload, false); else if (window.attachEvent) window.attachEvent("onload", downloadJsAtOnload); else window.onload = downloadJsAtOnload; </script><!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Finisky Garden" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Finisky Garden</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Easy doesn't enter into grown-up life.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
        <li class="menu-item menu-item-nlp"><a href="/tags/NLP/" rel="section"><i class="fa fa-language fa-fw"></i>NLP</a></li>
        <li class="menu-item menu-item-mongodb"><a href="/categories/MongoDB/" rel="section"><i class="fas fa-database fa-fw"></i>MongoDB</a></li>
        <li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fas fa-link fa-fw"></i>Links</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="nav-number">1.</span> <span class="nav-text">数据集</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%85%E6%B4%97%E6%95%B0%E6%8D%AE"><span class="nav-number">1.1.</span> <span class="nav-text">清洗数据</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9B%B8%E4%BC%BC%E5%BA%A6%E6%8C%87%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">相似度指标</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#authorship-attribution-confusion"><span class="nav-number">2.1.</span> <span class="nav-text">Authorship Attribution
Confusion</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#user-embedding"><span class="nav-number">2.2.</span> <span class="nav-text">User Embedding</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#perplexity-based"><span class="nav-number">2.3.</span> <span class="nav-text">Perplexity-Based</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E7%9B%B8%E4%BC%BC%E7%94%A8%E6%88%B7%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">3.</span> <span class="nav-text">如何使用相似用户的数据</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#weighted-sample-fine-tuning"><span class="nav-number">3.1.</span> <span class="nav-text">Weighted Sample Fine-tuning</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#interpolation-model"><span class="nav-number">3.2.</span> <span class="nav-text">Interpolation Model</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA"><span class="nav-number">4.</span> <span class="nav-text">结论</span></a></li></ol></div>
            <div class="site-author site-overview-item animated">
              <img class="site-author-image" itemprop="image" alt="finisky" src="/images/qrcode.jpg" />
              <p class="site-author-name">扫码关注公众号</p>
            </div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="finisky"
      src="/images/qrcode.jpg">
  <p class="site-author-name">扫码关注公众号</p>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">188</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">58</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://finisky.github.io/leveraging-similar-users-for-personalized-lm-paper-summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/qrcode.jpg">
      <meta itemprop="name" content="finisky">
      <meta itemprop="description" content="Easy doesn't enter into grown-up life.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Finisky Garden">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Leveraging Similar Users for Personalized Language Modeling with Limited Data 简读
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-10-08 19:28:27 / Modified: 19:37:31" itemprop="dateCreated datePublished" datetime="2022-10-08T19:28:27+08:00">2022-10-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Comments: </span>
  
    <a title="waline" href="/leveraging-similar-users-for-personalized-lm-paper-summary/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/leveraging-similar-users-for-personalized-lm-paper-summary/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-item" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="waline-pageview-count" data-path="/leveraging-similar-users-for-personalized-lm-paper-summary/"></span>
    </span>
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>今天来看看这篇 ACL2022 的文章：</p>
<p>[ACL2022] <a
target="_blank" rel="noopener" href="https://aclanthology.org/2022.acl-long.122/">Leveraging Similar
Users for Personalized Language Modeling with Limited Data</a></p>
<p>解决的问题很容易理解，个性化语言模型在用户刚加入时缺少数据的冷启动问题：</p>
<blockquote>
<p>Personalized language models are designed and trained to capture
language patterns specific to individual users.</p>
<p>However, when a new user joins a platform and not enough text is
available, it is harder to build effective personalized language
models.</p>
</blockquote>
<p>思路也比较直接，使用新用户的少量数据在已有用户中找到相似的用户，然后用相似用户的数据进行语言模型的训练，从而解决数据稀疏的问题。</p>
<p>实验论文，提出了三种不同的指标来进行用户相似度计算，实验证明 user
embedding + interpolate model效果最好。</p>
<span id="more"></span>
<h1 id="数据集">数据集</h1>
<p>使用Reddit评论数据集，并选择在2007-2015年至少有60K
token文字的用户。</p>
<ul>
<li>anchor users: 至少有250K
token文字的用户，作为已有用户的锚点，新用户进来后与这些锚点用户匹配。</li>
</ul>
<h2 id="清洗数据">清洗数据</h2>
<p>匹配上任意一条规则的post都会被过滤掉：</p>
<p><img
src="https://raw.githubusercontent.com/finisky/finiskyimages/master/nlp/postfilterrules.png" /></p>
<h1 id="相似度指标">相似度指标</h1>
<p>这张图看着很绕，没太看懂想表达的意思：</p>
<p><img
src="https://raw.githubusercontent.com/finisky/finiskyimages/master/nlp/similaritymetricsandpersonalizedmodels.png" /></p>
<h2 id="authorship-attribution-confusion">Authorship Attribution
Confusion</h2>
<p>此指标主要用于衡量句子集和anchor user之间的相似度。</p>
<p>给定一个用户的句子集合U，A(U) 给出该句子集和所有anchor
user的一个confusion vector。</p>
<p>不过看起来这个指标的test accuracy并不高：</p>
<blockquote>
<p>For K = 100 anchors the test accuracy is 42.88% and K = 10, 000 the
test accuracy is 2.42%. These accuracies are reasonably high given the
difficulty of the task.</p>
</blockquote>
<h2 id="user-embedding">User Embedding</h2>
<p>使用了一个已有模型，在训练语言模型时加入了user embedding:</p>
<blockquote>
<p>The embeddings of anchor users can be obtained from the user
embedding layer in the trained model. To learn the embeddings of new
users, we freeze all parameters of the trained model except the user
embedding layer.</p>
</blockquote>
<h2 id="perplexity-based">Perplexity-Based</h2>
<p>给定N个用户的个性化语言模型，我们可以用任意一个语言模型配上另一个用户的数据，通过PPL来评估相似度。论文先用所有anchor
user的数据训练了一个大模型，再用每个用户的数据finetune成N个不同的用户语言模型。</p>
<blockquote>
<p>We then measure the perplexity of each model on the data of each new
user.</p>
<p>This step is expensive, taking close to 24 hours for K = 100 and
intractable given our hardware constraints in the K = 10, 000
setting.</p>
</blockquote>
<h1 id="如何使用相似用户的数据">如何使用相似用户的数据</h1>
<p>两种方案：</p>
<h2 id="weighted-sample-fine-tuning">Weighted Sample Fine-tuning</h2>
<p>先用所有anchor
user的数据finetune一遍，再用新用户的少量数据finetune一遍：</p>
<blockquote>
<p>Our method of weighted sample fine-tuning has two steps. The first
step is to fine-tune the model trained on all anchor users on a new set
of similar users, as determined by our chosen similarity metric. Then we
fine-tune as in the standard case, by tuning on the new user’s data.</p>
</blockquote>
<h2 id="interpolation-model">Interpolation Model</h2>
<p>预测时，对每个anchor
user的语言模型预测结果根据新用户与该用户的相似度进行加权。公式就不列了，看起来计算量不小，每次推断都要经过N个相似用户的语言模型。</p>
<blockquote>
<p>Our interpolation model is built from individual LMs constructed for
each anchor user. It takes the predictions of each anchor user model and
weights their predictions by that anchor’s similarity to the new
user.</p>
</blockquote>
<h1 id="结论">结论</h1>
<blockquote>
<p>We found that the most easily scalable and highest performing method
was to use user embedding similarity and to interpolate similar user
fine-tuned models.</p>
</blockquote>
<p>总体来看，本文想法不复杂，但实现并不简单。特别是在每个用户数据上finetune语言模型和计算相似度，计算量过大，影响实用性。文章写得也比较散，建议借鉴本文的思想解决相关的问题。</p>

    </div>

    
    
    
      
  <div class="popular-posts-header">Related Posts</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/briefintrotoprompt.en/" rel="bookmark">Brief Introduction to NLP Prompting</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/briefintrotoprompt/" rel="bookmark">NLP Prompt技术简介</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/diamonte-dataset-paper-summary/" rel="bookmark">Towards Boosting the Open-Domain Chatbot with Human Feedback 简读</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/finetunelmlinebyline.en/" rel="bookmark">Fine-tune GPT with Line-by-Line Dataset</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/finetunelmlinebyline/" rel="bookmark">使用LineByLine数据集训练GPT</a></div>
    </li>
  </ul>


    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Machine-Learning/" rel="tag"># Machine Learning</a>
              <a href="/tags/NLP/" rel="tag"># NLP</a>
              <a href="/tags/NLG/" rel="tag"># NLG</a>
              <a href="/tags/Language-Model/" rel="tag"># Language Model</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/kai-juan-you-yi/" rel="prev" title="开卷有益？">
                  <i class="fa fa-chevron-left"></i> 开卷有益？
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/diamonte-dataset-paper-summary/" rel="next" title="Towards Boosting the Open-Domain Chatbot with Human Feedback 简读">
                  Towards Boosting the Open-Domain Chatbot with Human Feedback 简读 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">finisky</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div><div><span><a href="https://finicounter.vercel.app/" target="_blank">Total Pageview:</a></span><span id="finicount_views" style="display:inline;padding-left:5px;"></span><div> <script async src="//finicounter.vercel.app/finicounter.js"></script>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  




  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.1.4/es5/tex-mml-chtml.js","integrity":"sha256-ncNI9OXOS5Ek4tzVYiOMmN/KKCPZ6V0Cpv2P/zHntiA="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"en-US","enable":true,"serverURL":"https://finiskycomments.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":true,"pageSize":10,"el":"#waline","comment":true,"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","path":"/leveraging-similar-users-for-personalized-lm-paper-summary/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body>
</html>
